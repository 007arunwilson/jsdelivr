(function(a){function b(l,i){this.locale=l||"en";if(i){b.locale[this.locale]=i}else{while(this.locale&&!b.locale.hasOwnProperty(this.locale)){this.locale=this.locale.replace(/[-_]?[^-_]*$/,"")}if(!this.locale){if(typeof module!=="undefined"&&module.exports&&typeof require!=="undefined"){this.locale=l.replace(/[-_].*$/,"");var m=require("path"),h=require("fs"),g=require("vm"),f=require.resolve(m.join(__dirname,"locale",this.locale+".js"));try{var e=h.readFileSync(f);var k=g.createScript(e);k.runInNewContext({MessageFormat:b})}catch(j){j.message="Locale "+l+" could not be loaded: "+j.message;throw j}}else{throw new Error("Plural function not found for locale: "+l)}}}}c=function(e){if(!e){throw new Error("MessageFormat: No data passed to function.")}};n=function(g,e,f){if(isNaN(g[e])){throw new Error("MessageFormat: `"+e+"` isnt a number.")}return g[e]-(f||0)};v=function(f,e){c(f);return f[e]};p=function(i,f,h,e,g){c(i);return i[f] in g?g[i[f]]:(f=b.locale[e](i[f]-h),f in g?g[f]:g.other)};s=function(g,e,f){c(g);return g[e] in f?f[g[e]]:f.other};b.locale={en:function(e){if(e===1){return"one"}return"other"}};var d=(function(){function g(j,h){function i(){this.constructor=j}i.prototype=h.prototype;j.prototype=new i()}function e(k,j,l,m,h,i){this.message=k;this.expected=j;this.found=l;this.offset=m;this.line=h;this.column=i;this.name="SyntaxError"}g(e,Error);function f(a5){var ac=arguments.length>1?arguments[1]:{},aS={},q={start:k},aH=k,aA=function(bc){return{type:"program",program:bc}},ay=aS,aw=[],au=function(bf,bc){var bd=[];if(bf&&bf.val){bd.push(bf)}for(var be in bc){if(bc.hasOwnProperty(be)){bd.push(bc[be])}}return{type:"messageFormatPattern",statements:bd}},ar="{",ap={type:"literal",value:"{",description:'"{"'},an="}",al={type:"literal",value:"}",description:'"}"'},aj=function(be,bd){var bc=[];if(be){bc.push(be)}if(bd&&bd.val){bc.push(bd)}return{type:"messageFormatPatternRight",statements:bc}},ah=null,h=",",bb={type:"literal",value:",",description:'","'},a9=function(bc,be){var bd={type:"messageFormatElement",argumentIndex:bc};if(be&&be.length){bd.elementFormat=be[1]}else{bd.output=true}return bd},a8="plural",a7={type:"literal",value:"plural",description:'"plural"'},a6=function(bc,bd){return{type:"elementFormat",key:bc,val:bd.val}},a4="select",a2={type:"literal",value:"select",description:'"select"'},a1=function(bc){return{type:"pluralStyle",val:bc}},a0=function(bc){return{type:"selectStyle",val:bc}},aU=function(be,bc){var bd={type:"pluralFormatPattern",pluralForms:bc};if(be){bd.offset=be}else{bd.offset=0}return bd},aT="offset",aR={type:"literal",value:"offset",description:'"offset"'},aP=":",aO={type:"literal",value:":",description:'":"'},aN=function(bc){return bc},aM=function(bc){return{type:"selectFormatPattern",pluralForms:bc}},aK=function(bc,bd){return{type:"pluralForms",key:bc,val:bd}},aJ=function(bc){return bc},aI="=",az={type:"literal",value:"=",description:'"="'},ax=function(bc,bg){var bf=[];for(var be=0;be<bg.length;++be){for(var bd=0;bd<bg[be].length;++bd){bf.push(bg[be][bd])}}return{type:"string",val:bc+bf.join("")}},av=/^[0-9a-zA-Z$_]/,at={type:"class",value:"[0-9a-zA-Z$_]",description:"[0-9a-zA-Z$_]"},aq=/^[^ \t\n\r,.+={}]/,ao={type:"class",value:"[^ \\t\\n\\r,.+={}]",description:"[^ \\t\\n\\r,.+={}]"},am=function(bd,bc){return bd+(bc?bc.join(""):"")},ak=function(bc){return bc.join("")},ai=/^[^{}\\\0-\x1F \t\n\r]/,af={type:"class",value:"[^{}\\\\\\0-\\x1F \\t\\n\\r]",description:"[^{}\\\\\\0-\\x1F \\t\\n\\r]"},Y=function(bc){return bc},X="\\#",W={type:"literal",value:"\\#",description:'"\\\\#"'},U=function(){return"\\#"},T="\\{",Q={type:"literal",value:"\\{",description:'"\\\\{"'},P=function(){return"\u007B"},O="\\}",M={type:"literal",value:"\\}",description:'"\\\\}"'},L=function(){return"\u007D"},I="\\u",H={type:"literal",value:"\\u",description:'"\\\\u"'},G=function(bf,be,bd,bc){return String.fromCharCode(parseInt("0x"+bf+be+bd+bc))},F=/^[0-9]/,E={type:"class",value:"[0-9]",description:"[0-9]"},D=function(bc){return parseInt((bc.join("")),10)},C=/^[0-9a-fA-F]/,B={type:"class",value:"[0-9a-fA-F]",description:"[0-9a-fA-F]"},A={type:"other",description:"whitespace"},z=function(bc){return bc.join("")},u=/^[ \t\n\r]/,r={type:"class",value:"[ \\t\\n\\r]",description:"[ \\t\\n\\r]"},ae=0,R=0,aL=0,i={line:1,column:1,seenCR:false},V=0,a3=[],aa=0,t;if("startRule" in ac){if(!(ac.startRule in q)){throw new Error("Can't start parsing from rule \""+ac.startRule+'".')}aH=q[ac.startRule]}function aG(){return a5.substring(R,ae)}function o(){return R}function m(){return aC(R).line}function J(){return aC(R).column}function l(bc){throw aF(null,[{type:"other",description:bc}],R)}function aB(bc){throw aF(bc,null,R)}function aC(bd){function bc(bg,bf,be){var bi,bh;for(bi=bf;bi<be;bi++){bh=a5.charAt(bi);if(bh==="\n"){if(!bg.seenCR){bg.line++}bg.column=1;bg.seenCR=false}else{if(bh==="\r"||bh==="\u2028"||bh==="\u2029"){bg.line++;bg.column=1;bg.seenCR=true}else{bg.column++;bg.seenCR=false}}}}if(aL!==bd){if(aL>bd){aL=0;i={line:1,column:1,seenCR:false}}bc(i,aL,bd);aL=bd}return i}function S(bc){if(ae<V){return}if(ae>V){V=ae;a3=[]}a3.push(bc)}function aF(be,bd,bi){function bh(bk){var bj=1;bk.sort(function(bm,bl){if(bm.description<bl.description){return -1}else{if(bm.description>bl.description){return 1}else{return 0}}});while(bj<bk.length){if(bk[bj-1]===bk[bj]){bk.splice(bj,1)}else{bj++}}}function bc(bn,bo){function bj(bq){function br(bs){return bs.charCodeAt(0).toString(16).toUpperCase()}return bq.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(bs){return"\\x0"+br(bs)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(bs){return"\\x"+br(bs)}).replace(/[\u0180-\u0FFF]/g,function(bs){return"\\u0"+br(bs)}).replace(/[\u1080-\uFFFF]/g,function(bs){return"\\u"+br(bs)})}var bk=new Array(bn.length),bp,bl,bm;for(bm=0;bm<bn.length;bm++){bk[bm]=bn[bm].description}bp=bn.length>1?bk.slice(0,-1).join(", ")+" or "+bk[bn.length-1]:bk[0];bl=bo?'"'+bj(bo)+'"':"end of input";return"Expected "+bp+" but "+bl+" found."}var bg=aC(bi),bf=bi<a5.length?a5.charAt(bi):null;if(bd!==null){bh(bd)}return new e(be!==null?be:bc(bd,bf),bd,bf,bi,bg.line,bg.column)}function k(){var bd,bc;bd=ae;bc=aD();if(bc!==aS){R=bd;bc=aA(bc)}bd=bc;return bd}function aD(){var bf,be,bd,bc;bf=ae;be=K();if(be!==aS){bd=[];bc=j();while(bc!==aS){bd.push(bc);bc=j()}if(bd!==aS){R=bf;be=au(be,bd);bf=be}else{ae=bf;bf=ay}}else{ae=bf;bf=ay}return bf}function j(){var bh,bg,bf,be,bd,bc,bi;bh=ae;if(a5.charCodeAt(ae)===123){bg=ar;ae++}else{bg=aS;if(aa===0){S(ap)}}if(bg!==aS){bf=aX();if(bf!==aS){be=aE();if(be!==aS){bd=aX();if(bd!==aS){if(a5.charCodeAt(ae)===125){bc=an;ae++}else{bc=aS;if(aa===0){S(al)}}if(bc!==aS){bi=K();if(bi!==aS){R=bh;bg=aj(be,bi);bh=bg}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}return bh}function aE(){var bg,bf,be,bd,bc;bg=ae;bf=ad();if(bf!==aS){be=ae;if(a5.charCodeAt(ae)===44){bd=h;ae++}else{bd=aS;if(aa===0){S(bb)}}if(bd!==aS){bc=w();if(bc!==aS){bd=[bd,bc];be=bd}else{ae=be;be=ay}}else{ae=be;be=ay}if(be===aS){be=ah}if(be!==aS){R=bg;bf=a9(bf,be);bg=bf}else{ae=bg;bg=ay}}else{ae=bg;bg=ay}return bg}function w(){var bh,bg,bf,be,bd,bc,bj,bi;bh=ae;bg=aX();if(bg!==aS){if(a5.substr(ae,6)===a8){bf=a8;ae+=6}else{bf=aS;if(aa===0){S(a7)}}if(bf!==aS){be=aX();if(be!==aS){if(a5.charCodeAt(ae)===44){bd=h;ae++}else{bd=aS;if(aa===0){S(bb)}}if(bd!==aS){bc=aX();if(bc!==aS){bj=aW();if(bj!==aS){bi=aX();if(bi!==aS){R=bh;bg=a6(bf,bj);bh=bg}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}if(bh===aS){bh=ae;bg=aX();if(bg!==aS){if(a5.substr(ae,6)===a4){bf=a4;ae+=6}else{bf=aS;if(aa===0){S(a2)}}if(bf!==aS){be=aX();if(be!==aS){if(a5.charCodeAt(ae)===44){bd=h;ae++}else{bd=aS;if(aa===0){S(bb)}}if(bd!==aS){bc=aX();if(bc!==aS){bj=ba();if(bj!==aS){bi=aX();if(bi!==aS){R=bh;bg=a6(bf,bj);bh=bg}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}return bh}function aW(){var bd,bc;bd=ae;bc=ag();if(bc!==aS){R=bd;bc=a1(bc)}bd=bc;return bd}function ba(){var bd,bc;bd=ae;bc=aV();if(bc!==aS){R=bd;bc=a0(bc)}bd=bc;return bd}function ag(){var bf,be,bd,bc;bf=ae;be=Z();if(be===aS){be=ah}if(be!==aS){bd=[];bc=x();while(bc!==aS){bd.push(bc);bc=x()}if(bd!==aS){R=bf;be=aU(be,bd);bf=be}else{ae=bf;bf=ay}}else{ae=bf;bf=ay}return bf}function Z(){var bh,bg,bf,be,bd,bc,bj,bi;bh=ae;bg=aX();if(bg!==aS){if(a5.substr(ae,6)===aT){bf=aT;ae+=6}else{bf=aS;if(aa===0){S(aR)}}if(bf!==aS){be=aX();if(be!==aS){if(a5.charCodeAt(ae)===58){bd=aP;ae++}else{bd=aS;if(aa===0){S(aO)}}if(bd!==aS){bc=aX();if(bc!==aS){bj=aZ();if(bj!==aS){bi=aX();if(bi!==aS){R=bh;bg=aN(bj);bh=bg}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}return bh}function aV(){var be,bd,bc;be=ae;bd=[];bc=x();while(bc!==aS){bd.push(bc);bc=x()}if(bd!==aS){R=be;bd=aM(bd)}be=bd;return be}function x(){var bk,bj,bi,bh,bg,bf,be,bd,bc;bk=ae;bj=aX();if(bj!==aS){bi=ab();if(bi!==aS){bh=aX();if(bh!==aS){if(a5.charCodeAt(ae)===123){bg=ar;ae++}else{bg=aS;if(aa===0){S(ap)}}if(bg!==aS){bf=aX();if(bf!==aS){be=aD();if(be!==aS){bd=aX();if(bd!==aS){if(a5.charCodeAt(ae)===125){bc=an;ae++}else{bc=aS;if(aa===0){S(al)}}if(bc!==aS){R=bk;bj=aK(bi,be);bk=bj}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}}else{ae=bk;bk=ay}return bk}function ab(){var be,bd,bc;be=ae;bd=ad();if(bd!==aS){R=be;bd=aJ(bd)}be=bd;if(be===aS){be=ae;if(a5.charCodeAt(ae)===61){bd=aI;ae++}else{bd=aS;if(aa===0){S(az)}}if(bd!==aS){bc=aZ();if(bc!==aS){R=be;bd=aN(bc);be=bd}else{ae=be;be=ay}}else{ae=be;be=ay}}return be}function K(){var bh,bg,bf,be,bd,bc,bi;bh=ae;bg=aX();if(bg!==aS){bf=[];be=ae;bd=aX();if(bd!==aS){bc=aQ();if(bc!==aS){bi=aX();if(bi!==aS){bd=[bd,bc,bi];be=bd}else{ae=be;be=ay}}else{ae=be;be=ay}}else{ae=be;be=ay}while(be!==aS){bf.push(be);be=ae;bd=aX();if(bd!==aS){bc=aQ();if(bc!==aS){bi=aX();if(bi!==aS){bd=[bd,bc,bi];be=bd}else{ae=be;be=ay}}else{ae=be;be=ay}}else{ae=be;be=ay}}if(bf!==aS){R=bh;bg=ax(bg,bf);bh=bg}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}return bh}function ad(){var bg,bf,be,bd,bc;bg=ae;bf=aX();if(bf!==aS){if(av.test(a5.charAt(ae))){be=a5.charAt(ae);ae++}else{be=aS;if(aa===0){S(at)}}if(be!==aS){bd=[];if(aq.test(a5.charAt(ae))){bc=a5.charAt(ae);ae++}else{bc=aS;if(aa===0){S(ao)}}while(bc!==aS){bd.push(bc);if(aq.test(a5.charAt(ae))){bc=a5.charAt(ae);ae++}else{bc=aS;if(aa===0){S(ao)}}}if(bd!==aS){bc=aX();if(bc!==aS){R=bg;bf=am(be,bd);bg=bf}else{ae=bg;bg=ay}}else{ae=bg;bg=ay}}else{ae=bg;bg=ay}}else{ae=bg;bg=ay}return bg}function aQ(){var be,bd,bc;be=ae;bd=[];bc=N();if(bc!==aS){while(bc!==aS){bd.push(bc);bc=N()}}else{bd=ay}if(bd!==aS){R=be;bd=ak(bd)}be=bd;return be}function N(){var bh,bg,bf,be,bd,bc;bh=ae;if(ai.test(a5.charAt(ae))){bg=a5.charAt(ae);ae++}else{bg=aS;if(aa===0){S(af)}}if(bg!==aS){R=bh;bg=Y(bg)}bh=bg;if(bh===aS){bh=ae;if(a5.substr(ae,2)===X){bg=X;ae+=2}else{bg=aS;if(aa===0){S(W)}}if(bg!==aS){R=bh;bg=U()}bh=bg;if(bh===aS){bh=ae;if(a5.substr(ae,2)===T){bg=T;ae+=2}else{bg=aS;if(aa===0){S(Q)}}if(bg!==aS){R=bh;bg=P()}bh=bg;if(bh===aS){bh=ae;if(a5.substr(ae,2)===O){bg=O;ae+=2}else{bg=aS;if(aa===0){S(M)}}if(bg!==aS){R=bh;bg=L()}bh=bg;if(bh===aS){bh=ae;if(a5.substr(ae,2)===I){bg=I;ae+=2}else{bg=aS;if(aa===0){S(H)}}if(bg!==aS){bf=aY();if(bf!==aS){be=aY();if(be!==aS){bd=aY();if(bd!==aS){bc=aY();if(bc!==aS){R=bh;bg=G(bf,be,bd,bc);bh=bg}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}else{ae=bh;bh=ay}}}}}return bh}function aZ(){var be,bd,bc;be=ae;bd=[];if(F.test(a5.charAt(ae))){bc=a5.charAt(ae);ae++}else{bc=aS;if(aa===0){S(E)}}if(bc!==aS){while(bc!==aS){bd.push(bc);if(F.test(a5.charAt(ae))){bc=a5.charAt(ae);ae++}else{bc=aS;if(aa===0){S(E)}}}}else{bd=ay}if(bd!==aS){R=be;bd=D(bd)}be=bd;return be}function aY(){var bc;if(C.test(a5.charAt(ae))){bc=a5.charAt(ae);ae++}else{bc=aS;if(aa===0){S(B)}}return bc}function aX(){var be,bd,bc;aa++;be=ae;bd=[];bc=y();while(bc!==aS){bd.push(bc);bc=y()}if(bd!==aS){R=be;bd=z(bd)}be=bd;aa--;if(be===aS){bd=aS;if(aa===0){S(A)}}return be}function y(){var bc;if(u.test(a5.charAt(ae))){bc=a5.charAt(ae);ae++}else{bc=aS;if(aa===0){S(r)}}return bc}t=aH();if(t!==aS&&ae===a5.length){return t}else{if(t!==aS&&ae<a5.length){S({type:"end",description:"end of input"})}throw aF(null,a3,V)}}return{SyntaxError:e,parse:f}})();b.prototype.parse=function(){return d.parse.apply(d,arguments)};b.prototype.precompile=function(e){var f=this,h=false;function g(k){var j=JSON.parse(JSON.stringify(k));j.pf_count++;return j}function i(j,q){q=q||{keys:{},offset:{}};var m=[],l,k;switch(j.type){case"program":return i(j.program);case"messageFormatPattern":for(l=0;l<j.statements.length;++l){m.push(i(j.statements[l],q))}k=m.join("+")||'""';return q.pf_count?k:"function(d){return "+k+"}";case"messageFormatPatternRight":for(l=0;l<j.statements.length;++l){m.push(i(j.statements[l],q))}return m.join("+");case"messageFormatElement":q.pf_count=q.pf_count||0;if(j.output){return'v(d,"'+j.argumentIndex+'")'}else{q.keys[q.pf_count]='"'+j.argumentIndex+'"';return i(j.elementFormat,q)}return"";case"elementFormat":if(j.key==="select"){return"s(d,"+q.keys[q.pf_count]+","+i(j.val,q)+")"}else{if(j.key==="plural"){q.offset[q.pf_count||0]=j.val.offset||0;return"p(d,"+q.keys[q.pf_count]+","+(q.offset[q.pf_count]||0)+',"'+f.locale+'",'+i(j.val,q)+")"}}return"";case"pluralFormatPattern":q.pf_count=q.pf_count||0;h=true;for(l=0;l<j.pluralForms.length;++l){if(j.pluralForms[l].key==="other"){h=false}m.push('"'+j.pluralForms[l].key+'":'+i(j.pluralForms[l].val,g(q)))}if(h){throw new Error("No 'other' form found in pluralFormatPattern "+q.pf_count)}return"{"+m.join(",")+"}";case"selectFormatPattern":q.pf_count=q.pf_count||0;q.offset[q.pf_count]=0;h=true;for(l=0;l<j.pluralForms.length;++l){if(j.pluralForms[l].key==="other"){h=false}m.push('"'+j.pluralForms[l].key+'":'+i(j.pluralForms[l].val,g(q)))}if(h){throw new Error("No 'other' form found in selectFormatPattern "+q.pf_count)}return"{"+m.join(",")+"}";case"string":k='"'+(j.val||"").replace(/\n/g,"\\n").replace(/"/g,'\\"')+'"';if(q.pf_count){var t=q.offset[q.pf_count-1];k=k.replace(/(^|[^\\])#/g,'$1"+n(d,'+q.keys[q.pf_count-1]+(t?","+t:"")+')+"');k=k.replace(/^""\+/,"").replace(/\+""$/,"")}return k;default:throw new Error("Bad AST type: "+j.type)}}return i(e)};b.prototype.compile=function(e){return(new Function("MessageFormat","return "+this.precompile(this.parse(e))))(b)};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=b}exports.MessageFormat=b}else{if(typeof define==="function"&&define.amd){define(function(){return b})}else{a.MessageFormat=b}}})(this);
